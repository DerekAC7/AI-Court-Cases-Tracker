<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>AI Court Cases Tracker</title>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<style>
  :root { --fg:#0f172a; --muted:#475569; --bg:#ffffff; --card:#f8fafc; --line:#e2e8f0; --pill:#0ea5e9; }
  *{box-sizing:border-box}
  html,body{margin:0;padding:0}
  body{font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; color:var(--fg); background:var(--bg); padding:24px;}
  h1{margin:0 0 6px 0; font-size:24px; font-weight:700}
  .sub{color:var(--muted); margin-bottom:16px; font-size:14px}
  .toolbar{display:flex; gap:12px; margin:10px 0 18px; flex-wrap:wrap}
  input,select{padding:10px 12px; border:1px solid var(--line); border-radius:10px; font-size:14px}
  .grid{display:grid; grid-template-columns:repeat(auto-fill, minmax(420px,1fr)); gap:14px}
  .card{background:var(--card); border:1px solid var(--line); border-radius:14px; padding:16px; display:flex; flex-direction:column; gap:10px}
  .title{font-weight:700; font-size:16px; line-height:1.35}
  .meta{font-size:12px; color:var(--muted); display:flex; gap:8px; align-items:center; flex-wrap:wrap}
  .pill{background:var(--pill); color:#fff; border-radius:999px; padding:3px 8px; font-size:11px; font-weight:600}
  .summary{font-size:14px; line-height:1.45}
  .footer{display:flex; justify-content:flex-end}
  .linkbtn{display:inline-block; padding:8px 10px; border-radius:10px; border:1px solid var(--line); background:#fff; font-size:13px; text-decoration:none}
  .linkbtn:hover{text-decoration:underline}
</style>
</head>
<body>
  <h1>AI Court Cases Tracker</h1>
  <div class="sub">Case summaries across multiple trackers. Updates via GitHub Actions.</div>
  <div class="toolbar">
    <input id="q" type="search" placeholder="Filter by case, outcome, source…" aria-label="Filter"/>
    <select id="status" aria-label="Filter by status">
      <option value="">Status: All</option>
      <option>Recently filed</option>
      <option>Open/Active</option>
      <option>Judgment</option>
      <option>Dismissed</option>
      <option>Injunction</option>
      <option>Settled</option>
      <option>Class certified</option>
      <option>MDL/Transfer</option>
      <option>Stayed/Remand</option>
    </select>
    <select id="sort" aria-label="Sort">
      <option value="title">Sort: Title</option>
      <option value="status">Sort: Status</option>
      <option value="source">Sort: Source</option>
    </select>
  </div>
  <div id="list" class="grid"></div>

<script>
async function load() {
  const res = await fetch('cases.json', {cache:'no-store'});
  const data = await res.json();

  const list = document.getElementById('list');
  const q = document.getElementById('q');
  const sortSel = document.getElementById('sort');
  const statusSel = document.getElementById('status');

  function render(filter='', sortBy='title', statusFilter='') {
    const f = filter.toLowerCase();
    let items = data.filter(c => {
      const hay = (c.title + ' ' + (c.outcome||'') + ' ' + (c.source||'') + ' ' + (c.summary||'') + ' ' + (c.status||'')).toLowerCase();
      const passText = !f || hay.includes(f);
      const passStatus = !statusFilter || (c.status||'').toLowerCase() === statusFilter.toLowerCase();
      return passText && passStatus;
    });

    items.sort((a,b)=>{
      const A=(a[sortBy]||'').toString().toLowerCase();
      const B=(b[sortBy]||'').toString().toLowerCase();
      return A.localeCompare(B);
    });

    list.innerHTML = '';
    items.forEach(c=>{
      const url = c.url || '#';
      const outcome = c.outcome || 'Update';
      const status  = c.status || 'Open/Active';
      const headline = (c.headline || c.title) + ' – ' + outcome + '.';
      const src = c.source || '';
      const takeaway = c.takeaway ? `<div class="summary"><strong>Key takeaway:</strong> ${c.takeaway}</div>` : '';

      const card = document.createElement('div');
      card.className = 'card';
      card.innerHTML = `
        <div class="title">${headline}</div>
        <div class="meta">
          <span class="pill">${status}</span>
          <span>${src}</span>
        </div>
        <div class="summary">${c.summary || 'No summary provided by source.'}</div>
        ${takeaway}
        <div class="footer">
          <a class="linkbtn" href="${url}" target="_blank" rel="noopener">View source →</a>
        </div>
      `;
      list.appendChild(card);
    });
  }

  q.addEventListener('input', (e)=>render(e.target.value, sortSel.value, statusSel.value));
  sortSel.addEventListener('change', ()=>render(q.value, sortSel.value, statusSel.value));
  statusSel.addEventListener('change', ()=>render(q.value, sortSel.value, statusSel.value));
  render();
}
load();
</script>
</body>
</html>
